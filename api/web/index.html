<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NBA Stables - Live NBA Scores, Stats & Player Tracker</title>
    <meta name="description" content="Free live NBA scores, box scores, standings, injury reports and player tracking. Real-time stats with a clean, modern interface. No ads, no tracking.">
    <meta name="keywords" content="NBA, basketball, live scores, NBA stats, player tracker, box scores, standings, injury report, NBA API">
    <meta name="author" content="NBA Stables">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://nba-stables.onrender.com/">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://nba-stables.onrender.com/">
    <meta property="og:title" content="NBA Stables - Live NBA Scores & Stats">
    <meta property="og:description" content="Free live NBA scores, box scores, standings, injury reports and player tracking. Real-time stats with no ads.">
    <meta property="og:image" content="https://nba-stables.onrender.com/static/og-image.png">
    <meta property="og:site_name" content="NBA Stables">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://nba-stables.onrender.com/">
    <meta name="twitter:title" content="NBA Stables - Live NBA Scores & Stats">
    <meta name="twitter:description" content="Free live NBA scores, box scores, standings, injury reports and player tracking. Real-time stats with no ads.">
    <meta name="twitter:image" content="https://nba-stables.onrender.com/static/og-image.png">

    <!-- PWA -->
    <meta name="theme-color" content="#ff6b35">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="manifest" href="/api/web/web/manifest.json">
    <link rel="apple-touch-icon" href="/api/web/web/icon-192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/api/web/web/icon-192.png">

    <!-- JSON-LD Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "NBA Stables",
      "description": "Free live NBA scores, box scores, standings, injury reports and player tracking",
      "url": "https://nba-stables.onrender.com/",
      "applicationCategory": "SportsApplication",
      "operatingSystem": "Any",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "featureList": [
        "Live NBA Scores",
        "Box Scores",
        "Player Tracker",
        "Standings",
        "Injury Reports",
        "Desktop Widgets",
        "Android Widget"
      ]
    }
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --bg-card: #1a1a24;
            --bg-hover: #22222e;
            --text-primary: #ffffff;
            --text-secondary: #a0a0b0;
            --accent: #ff6b35;
            --accent-light: #ff8c5a;
            --success: #4ade80;
            --border: #2a2a3a;
            --gradient-1: linear-gradient(135deg, #ff6b35 0%, #ff8c5a 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.5;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        header {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
            padding: 20px 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: var(--gradient-1);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .logo h1 {
            font-size: 1.5rem;
            font-weight: 700;
            background: var(--gradient-1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header-date {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Navigation */
        nav {
            background: var(--bg-secondary);
            padding: 15px 0;
            border-bottom: 1px solid var(--border);
        }

        .nav-tabs {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            padding-bottom: 5px;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
        }

        .nav-tabs::-webkit-scrollbar {
            display: none;
        }

        .nav-tab {
            padding: 10px 20px;
            background: transparent;
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .nav-tab:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .nav-tab.active {
            background: var(--accent);
            border-color: var(--accent);
            color: white;
        }

        /* Main Content */
        main {
            padding: 30px 0;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title .badge {
            background: var(--accent);
            color: white;
            font-size: 0.75rem;
            padding: 4px 10px;
            border-radius: 20px;
            font-weight: 500;
        }

        /* Cards */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 20px;
        }

        /* Compact grid for scoreboard */
        .cards-grid-compact {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
            gap: 12px;
        }

        .card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        /* Game Card - Compact */
        .game-card {
            padding: 12px;
        }

        .game-status {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 20px;
            font-size: 0.65rem;
            font-weight: 600;
            margin-bottom: 8px;
            text-transform: uppercase;
        }

        .game-status.live {
            background: #ef4444;
            color: white;
            animation: pulse 2s infinite;
        }

        .game-status.final {
            background: var(--bg-hover);
            color: var(--text-secondary);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .teams-container {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .team-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 10px;
            background: var(--bg-secondary);
            border-radius: 6px;
        }

        .team-info {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .team-tricode {
            font-size: 0.75rem;
            color: var(--text-secondary);
            background: var(--bg-hover);
            padding: 2px 6px;
            border-radius: 4px;
            min-width: 32px;
            text-align: center;
        }

        .team-name {
            font-weight: 600;
            font-size: 0.85rem;
        }

        .team-score {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--accent);
            min-width: 36px;
            text-align: right;
        }

        .leader-section {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid var(--border);
        }

        .leader-title {
            font-size: 0.65rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            margin-bottom: 6px;
        }

        .leader-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 4px 0;
        }

        .leader-name {
            font-weight: 500;
            font-size: 0.8rem;
            color: var(--text-primary);
        }

        .leader-stats {
            display: flex;
            gap: 10px;
        }

        .stat {
            text-align: center;
        }

        .stat-value {
            font-weight: 600;
            font-size: 0.85rem;
            color: var(--accent);
        }

        .stat-label {
            font-size: 0.6rem;
            color: var(--text-secondary);
            text-transform: uppercase;
        }

        /* Box Score */
        .boxscore-card {
            overflow-x: auto;
        }

        .boxscore-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.75rem;
        }

        .boxscore-table th,
        .boxscore-table td {
            padding: 4px 6px;
            text-align: center;
            border-bottom: 1px solid var(--border);
        }

        .boxscore-table th {
            background: var(--bg-secondary);
            color: var(--text-secondary);
            font-weight: 500;
            font-size: 0.65rem;
            text-transform: uppercase;
        }

        .boxscore-table td:first-child {
            text-align: left;
            font-weight: 600;
        }

        .boxscore-table tr:hover td {
            background: var(--bg-hover);
        }

        .highlight {
            color: var(--success);
            font-weight: 600;
        }

        /* Leaders Section */
        .leaders-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .leader-card {
            padding: 20px;
        }

        .leader-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .leader-category {
            font-weight: 600;
            font-size: 1rem;
        }

        .leader-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent);
        }

        .leader-players {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .leader-player {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: var(--bg-secondary);
            border-radius: 8px;
        }

        .leader-player-name {
            font-weight: 500;
        }

        .leader-player-team {
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        /* Player Tracker */
        .player-search {
            margin-bottom: 30px;
        }

        .search-container {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .search-input-wrapper {
            flex: 1;
            min-width: 300px;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 15px 20px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 10px;
            color: var(--text-primary);
            font-size: 1rem;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--accent);
        }

        .search-input::placeholder {
            color: var(--text-secondary);
        }

        .search-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 10px;
            margin-top: 5px;
            max-height: 300px;
            overflow-y: auto;
            z-index: 50;
            display: none;
        }

        .search-results.show {
            display: block;
        }

        .search-result-item {
            padding: 12px 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            border-bottom: 1px solid var(--border);
        }

        .search-result-item:hover {
            background: var(--bg-hover);
        }

        .search-result-item:last-child {
            border-bottom: none;
        }

        .tracked-players {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .player-chip {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 15px;
            background: var(--bg-card);
            border: 1px solid var(--accent);
            border-radius: 20px;
            font-size: 0.9rem;
            width: fit-content;
        }

        .player-chip-remove {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 1.2rem;
            line-height: 1;
        }

        .player-chip-remove:hover {
            color: #ef4444;
        }

        .btn {
            padding: 15px 30px;
            background: var(--gradient-1);
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(255, 107, 53, 0.3);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .player-stats-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .player-stats-table th,
        .player-stats-table td {
            padding: 15px;
            text-align: center;
            border-bottom: 1px solid var(--border);
        }

        .player-stats-table th {
            background: var(--bg-secondary);
            color: var(--text-secondary);
            font-weight: 500;
            font-size: 0.8rem;
            text-transform: uppercase;
        }

        .player-stats-table td:first-child {
            text-align: left;
        }

        .player-stats-table tbody tr:hover {
            background: var(--bg-hover);
        }

        /* Loading State */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 60px;
            color: var(--text-secondary);
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border);
            border-top-color: var(--accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 15px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .empty-state-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 10px;
        }

        /* Refresh Button */
        .refresh-btn {
            background: var(--bg-hover);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            padding: 8px 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
        }

        .refresh-btn:hover {
            background: var(--bg-card);
        }

        /* Date Selector */
        .date-selector {
            display: flex;
            gap: 8px;
            align-items: center;
            margin-bottom: 20px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
            padding-bottom: 5px;
        }

        .date-selector::-webkit-scrollbar {
            display: none;
        }

        .date-btn {
            padding: 8px 16px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 0.85rem;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .date-btn:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .date-btn.active {
            background: var(--accent);
            border-color: var(--accent);
            color: white;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 0 12px;
            }

            .cards-grid {
                grid-template-columns: 1fr;
            }

            .leaders-grid {
                grid-template-columns: 1fr;
            }

            .header-content {
                flex-direction: column;
                gap: 8px;
            }

            header {
                padding: 12px 0;
            }

            nav {
                padding: 10px 0;
                position: sticky;
                top: 58px;
                z-index: 99;
            }

            .nav-tab {
                padding: 8px 14px;
                font-size: 0.8rem;
                flex-shrink: 0;
            }

            .section-title {
                font-size: 1.2rem;
                flex-wrap: wrap;
            }

            main {
                padding: 16px 0;
            }

            .search-container {
                flex-direction: column;
            }

            .search-input-wrapper {
                min-width: 100%;
            }

            .search-input {
                padding: 12px 16px;
            }

            .btn {
                padding: 12px 20px;
                width: 100%;
            }

            .boxscore-table th,
            .boxscore-table td {
                padding: 3px 4px;
                font-size: 0.65rem;
            }

            .player-stats-table th,
            .player-stats-table td {
                padding: 10px 6px;
                font-size: 0.75rem;
            }

            .date-btn {
                padding: 6px 12px;
                font-size: 0.8rem;
            }

            .loading {
                padding: 30px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">&#127936;</div>
                    <h1>NBA Stables</h1>
                </div>
                <div class="header-date" id="currentDate">Loading...</div>
            </div>
        </div>
    </header>

    <nav>
        <div class="container">
            <div class="nav-tabs">
                <button class="nav-tab active" data-section="scoreboard">Live Scoreboard</button>
                <button class="nav-tab" data-section="boxscores">Box Scores</button>
                <button class="nav-tab" data-section="leaders">Daily Leaders</button>
                <button class="nav-tab" data-section="tracker">Player Tracker</button>
                <button class="nav-tab" data-section="standings">Standings</button>
                <button class="nav-tab" data-section="injuries">Injuries</button>
                <button class="nav-tab" data-section="lastngames">Last N Games</button>
                <button class="nav-tab" data-section="download">App</button>
                <a href="/about" class="nav-tab" style="text-decoration: none;">About</a>
            </div>
        </div>
    </nav>

    <main>
        <div class="container">
            <!-- Scoreboard Section -->
            <section id="scoreboard" class="section active">
                <div class="section-title">
                    Live Scoreboard
                    <span class="badge" id="gamesCount">0 Games</span>
                    <button class="refresh-btn" onclick="loadScoreboard()">&#8635; Refresh</button>
                </div>
                <div id="scoreboardContent" class="cards-grid-compact">
                    <div class="loading"><div class="spinner"></div> Loading games...</div>
                </div>
            </section>

            <!-- Box Scores Section -->
            <section id="boxscores" class="section">
                <div class="section-title">
                    Box Scores
                    <button class="refresh-btn" onclick="loadBoxscores()">&#8635; Refresh</button>
                </div>
                <div class="date-selector">
                    <button class="date-btn active" data-offset="0">Today</button>
                    <button class="date-btn" data-offset="1">-1d</button>
                    <button class="date-btn" data-offset="2">-2d</button>
                    <button class="date-btn" data-offset="3">-3d</button>
                    <button class="date-btn" data-offset="4">-4d</button>
                    <button class="date-btn" data-offset="5">-5d</button>
                    <button class="date-btn" data-offset="6">-6d</button>
                    <button class="date-btn" data-offset="7">-7d</button>
                </div>
                <div id="boxscoresContent">
                    <div class="loading"><div class="spinner"></div> Loading box scores...</div>
                </div>
            </section>

            <!-- Leaders Section -->
            <section id="leaders" class="section">
                <div class="section-title">
                    Daily Leaders
                    <button class="refresh-btn" onclick="loadLeaders()">&#8635; Refresh</button>
                </div>
                <div class="date-selector" id="leadersDateSelector">
                    <button class="date-btn active" data-offset="0">Today</button>
                    <button class="date-btn" data-offset="1">-1d</button>
                    <button class="date-btn" data-offset="2">-2d</button>
                    <button class="date-btn" data-offset="3">-3d</button>
                    <button class="date-btn" data-offset="4">-4d</button>
                    <button class="date-btn" data-offset="5">-5d</button>
                    <button class="date-btn" data-offset="6">-6d</button>
                    <button class="date-btn" data-offset="7">-7d</button>
                </div>
                <div id="leadersContent" class="leaders-grid">
                    <div class="loading"><div class="spinner"></div> Loading leaders...</div>
                </div>
            </section>

            <!-- Player Tracker Section -->
            <section id="tracker" class="section">
                <div class="section-title">Player Tracker</div>
                <div class="player-search">
                    <div class="search-container">
                        <div class="search-input-wrapper">
                            <input type="text" class="search-input" id="playerSearch" placeholder="Search for a player..." autocomplete="off">
                            <div class="search-results" id="searchResults"></div>
                        </div>
                        <button class="btn" id="trackBtn" onclick="loadTrackedStats()" disabled>Get Live Stats</button>
                    </div>
                    <div class="tracked-players" id="trackedPlayers"></div>
                </div>
                <div id="trackerContent">
                    <div class="empty-state">
                        <div class="empty-state-icon">&#127942;</div>
                        <div class="empty-state-title">Track Your Favorite Players</div>
                        <p>Search and select players above to see their live game stats</p>
                    </div>
                </div>
            </section>

            <!-- Standings Section -->
            <section id="standings" class="section">
                <div class="section-title">
                    NBA Standings
                    <button class="refresh-btn" onclick="loadStandings()">&#8635; Refresh</button>
                </div>
                <div id="standingsContent" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(min(500px, 100%), 1fr)); gap: 20px;">
                    <div class="loading"><div class="spinner"></div> Loading standings...</div>
                </div>
            </section>

            <!-- Injuries Section -->
            <section id="injuries" class="section">
                <div class="section-title">
                    Injury Report
                    <span class="badge" id="injuriesSourceBadge" style="background: #ef4444;">CBS</span>
                    <button class="refresh-btn" onclick="loadInjuries()">&#8635; Refresh</button>
                </div>
                <div style="margin-bottom: 20px; display: flex; gap: 20px; flex-wrap: wrap;">
                    <div>
                        <button class="date-btn active" id="injuriesListBtn" onclick="setInjuriesView('list')">All Players</button>
                        <button class="date-btn" id="injuriesGroupBtn" onclick="setInjuriesView('grouped')">Group by Team</button>
                    </div>
                </div>
                <div id="injuriesContent">
                    <div class="loading"><div class="spinner"></div> Loading injury report...</div>
                </div>
            </section>

            <!-- Last N Games Section -->
            <section id="lastngames" class="section">
                <div class="section-title">Last N Games</div>
                <div class="player-search">
                    <div class="search-container">
                        <div class="search-input-wrapper">
                            <input type="text" class="search-input" id="lastNSearch" placeholder="Search for a player..." autocomplete="off">
                            <div class="search-results" id="lastNSearchResults"></div>
                        </div>
                        <button class="btn" id="lastNBtn" onclick="loadLastNGames()" disabled>Get Stats</button>
                    </div>
                    <div style="display: flex; gap: 8px; align-items: center; margin-top: 12px;">
                        <span style="color: var(--text-secondary); font-size: 0.85rem; white-space: nowrap;">Last:</span>
                        <button class="date-btn active" data-n="5" style="padding: 8px 10px; min-width: unset;">5</button>
                        <button class="date-btn" data-n="10" style="padding: 8px 10px; min-width: unset;">10</button>
                        <button class="date-btn" data-n="15" style="padding: 8px 10px; min-width: unset;">15</button>
                    </div>
                    <div id="lastNPlayerChip" style="margin-top: 10px;"></div>
                </div>
                <div id="lastNContent">
                    <div class="empty-state">
                        <div class="empty-state-icon">&#128202;</div>
                        <div class="empty-state-title">Last N Games Stats</div>
                        <p>Search for a player to view their recent game log</p>
                    </div>
                </div>
            </section>

            <!-- App Section -->
            <section id="download" class="section">
                <div class="section-title">NBA Stables App</div>
                <div class="card" style="padding: 30px; max-width: 500px;">
                    <div style="text-align: center;">
                        <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #ff6b35, #ff8c5a); border-radius: 20px; margin: 0 auto 15px; display: flex; align-items: center; justify-content: center; font-size: 40px;">&#127936;</div>
                        <h2 style="margin-bottom: 10px;">Coming Soon</h2>
                        <p style="color: var(--text-secondary); margin-bottom: 20px;">We're building a native Android app with a home screen widget for live NBA scores.</p>
                        <ul style="color: var(--text-secondary); text-align: left; padding-left: 20px; line-height: 2; margin-bottom: 20px;">
                            <li>Live scores widget on your home screen</li>
                            <li>Auto-updates during games</li>
                            <li>Dark theme, minimal design</li>
                            <li>No ads, no tracking</li>
                        </ul>
                        <p style="color: var(--text-secondary); font-size: 0.85rem;">In the meantime, you can install this site as a PWA — tap your browser's "Add to Home Screen" option.</p>
                    </div>
                </div>
            </section>

        </div>
    </main>

    <script>
        const API_BASE = '';
        let trackedPlayerIds = [];
        let currentBoxscoreOffset = 0;
        let currentLeadersOffset = 0;

        // Navigation
        document.querySelectorAll('.nav-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));

                tab.classList.add('active');
                document.getElementById(tab.dataset.section).classList.add('active');

                // Load data when switching tabs
                switch(tab.dataset.section) {
                    case 'scoreboard': loadScoreboard(); break;
                    case 'boxscores': loadBoxscores(); break;
                    case 'leaders': loadLeaders(); break;
                    case 'standings': loadStandings(); break;
                    case 'injuries': loadInjuries(); break;
                }
            });
        });

        // Date selectors
        document.querySelectorAll('#boxscores .date-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('#boxscores .date-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentBoxscoreOffset = parseInt(btn.dataset.offset);
                loadBoxscores();
            });
        });

        document.querySelectorAll('#leadersDateSelector .date-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('#leadersDateSelector .date-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentLeadersOffset = parseInt(btn.dataset.offset);
                loadLeaders();
            });
        });

        // Load Scoreboard
        async function loadScoreboard() {
            const container = document.getElementById('scoreboardContent');
            container.innerHTML = '<div class="loading"><div class="spinner"></div> Loading games...</div>';

            try {
                const res = await fetch(`${API_BASE}/api/scoreboard`);
                const data = await res.json();

                document.getElementById('currentDate').textContent = data.date;
                document.getElementById('gamesCount').textContent = `${data.games.length} Games`;

                if (data.games.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-state-icon">&#127944;</div>
                            <div class="empty-state-title">No Games Today</div>
                            <p>Check back later for live games</p>
                        </div>
                    `;
                    return;
                }

                const score = (v) => (v == null || v === 'null') ? '-' : v;
                const hasLeader = (leader) => leader && leader.name && leader.name !== 'null';

                container.innerHTML = data.games.map(game => `
                    <div class="card game-card">
                        <span class="game-status ${game.status.toLowerCase().includes('final') ? 'final' : 'live'}">${game.status}</span>
                        <div class="teams-container">
                            <div class="team-row">
                                <div class="team-info">
                                    <span class="team-tricode">${game.homeTeam.tricode}</span>
                                    <span class="team-name">${game.homeTeam.name}</span>
                                </div>
                                <span class="team-score">${score(game.homeTeam.score)}</span>
                            </div>
                            <div class="team-row">
                                <div class="team-info">
                                    <span class="team-tricode">${game.awayTeam.tricode}</span>
                                    <span class="team-name">${game.awayTeam.name}</span>
                                </div>
                                <span class="team-score">${score(game.awayTeam.score)}</span>
                            </div>
                        </div>
                        ${hasLeader(game.homeTeam.leader) || hasLeader(game.awayTeam.leader) ? `
                        <div class="leader-section">
                            <div class="leader-title">Top Performers</div>
                            ${hasLeader(game.homeTeam.leader) ? `
                            <div class="leader-row">
                                <span class="leader-name">${game.homeTeam.leader.name}</span>
                                <div class="leader-stats">
                                    <div class="stat"><div class="stat-value">${score(game.homeTeam.leader.points)}</div><div class="stat-label">PTS</div></div>
                                    <div class="stat"><div class="stat-value">${score(game.homeTeam.leader.rebounds)}</div><div class="stat-label">REB</div></div>
                                    <div class="stat"><div class="stat-value">${score(game.homeTeam.leader.assists)}</div><div class="stat-label">AST</div></div>
                                </div>
                            </div>` : ''}
                            ${hasLeader(game.awayTeam.leader) ? `
                            <div class="leader-row">
                                <span class="leader-name">${game.awayTeam.leader.name}</span>
                                <div class="leader-stats">
                                    <div class="stat"><div class="stat-value">${score(game.awayTeam.leader.points)}</div><div class="stat-label">PTS</div></div>
                                    <div class="stat"><div class="stat-value">${score(game.awayTeam.leader.rebounds)}</div><div class="stat-label">REB</div></div>
                                    <div class="stat"><div class="stat-value">${score(game.awayTeam.leader.assists)}</div><div class="stat-label">AST</div></div>
                                </div>
                            </div>` : ''}
                        </div>` : ''}
                    </div>
                `).join('');
            } catch (error) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">&#9888;</div>
                        <div class="empty-state-title">Error Loading Games</div>
                        <p>${error.message}</p>
                    </div>
                `;
            }
        }

        // Load Box Scores
        async function loadBoxscores() {
            const container = document.getElementById('boxscoresContent');
            container.innerHTML = '<div class="loading"><div class="spinner"></div> Loading box scores...</div>';

            try {
                const res = await fetch(`${API_BASE}/api/boxscores?days_offset=${currentBoxscoreOffset}`);
                const data = await res.json();

                if (data.boxscores.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-state-icon">&#128202;</div>
                            <div class="empty-state-title">No Box Scores Available</div>
                            <p>No completed games for ${data.date}</p>
                        </div>
                    `;
                    return;
                }

                const isMobile = window.innerWidth <= 768;
                container.innerHTML = data.boxscores.map(game => {
                    if (isMobile) {
                        return `
                    <div class="card boxscore-card" style="margin-bottom: 16px; cursor: pointer;" onclick="toggleGameDetails('${game.gameId}', this)">
                        ${game.teams.map(team => `
                        <div style="padding: 12px; ${game.teams.indexOf(team) === 0 ? 'border-bottom: 1px solid var(--border);' : ''}">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <span style="font-weight: 600; font-size: 0.95rem;">${team.name}</span>
                                <span style="font-size: 1.3rem; font-weight: 700; color: var(--accent);">${team.score}</span>
                            </div>
                            <div style="display: flex; gap: 8px; flex-wrap: wrap; font-size: 0.7rem; color: var(--text-secondary);">
                                <span>FG ${(team.stats.fgPct * 100).toFixed(0)}%</span>
                                <span>3P ${(team.stats.threePtPct * 100).toFixed(0)}%</span>
                                <span>FT ${(team.stats.ftPct * 100).toFixed(0)}%</span>
                                <span>REB ${team.stats.rebounds}</span>
                                <span>AST ${team.stats.assists}</span>
                                <span>TO ${team.stats.turnovers}</span>
                            </div>
                            <div style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 6px;">
                                ${team.leader.name} <span style="color: var(--accent);">${team.leader.points}/${team.leader.rebounds}/${team.leader.assists}</span>
                            </div>
                        </div>
                        `).join('')}
                        <div style="text-align: center; padding: 8px; color: var(--text-secondary); font-size: 0.75rem; border-top: 1px solid var(--border);">
                            Tap for player details ▼
                        </div>
                        <div class="game-details" id="details-${game.gameId}" style="display: none;"></div>
                    </div>`;
                    } else {
                        return `
                    <div class="card boxscore-card" style="margin-bottom: 20px; cursor: pointer;" onclick="toggleGameDetails('${game.gameId}', this)">
                        <table class="boxscore-table">
                            <thead>
                                <tr>
                                    <th>Team</th>
                                    <th>Score</th>
                                    <th>FG</th>
                                    <th>FG%</th>
                                    <th>3PT</th>
                                    <th>3P%</th>
                                    <th>FT</th>
                                    <th>FT%</th>
                                    <th>REB</th>
                                    <th>AST</th>
                                    <th>STL</th>
                                    <th>BLK</th>
                                    <th>TO</th>
                                    <th>Leader  |PTS|REB|AST|</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${game.teams.map(team => `
                                    <tr>
                                        <td>${team.name}</td>
                                        <td class="highlight">${team.score}</td>
                                        <td>${team.stats.fg}</td>
                                        <td>${(team.stats.fgPct * 100).toFixed(1)}%</td>
                                        <td>${team.stats.threePt}</td>
                                        <td>${(team.stats.threePtPct * 100).toFixed(1)}%</td>
                                        <td>${team.stats.ft}</td>
                                        <td>${(team.stats.ftPct * 100).toFixed(1)}%</td>
                                        <td>${team.stats.rebounds}</td>
                                        <td>${team.stats.assists}</td>
                                        <td>${team.stats.steals}</td>
                                        <td>${team.stats.blocks}</td>
                                        <td>${team.stats.turnovers}</td>
                                        <td>${team.leader.name}  |${team.leader.points}|${team.leader.rebounds}|${team.leader.assists}|</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                        <div style="text-align: center; padding: 8px; color: var(--text-secondary); font-size: 0.8rem;">
                            Click to see player details ▼
                        </div>
                        <div class="game-details" id="details-${game.gameId}" style="display: none;"></div>
                    </div>`;
                    }
                }).join('');
            } catch (error) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">&#9888;</div>
                        <div class="empty-state-title">Error Loading Box Scores</div>
                        <p>${error.message}</p>
                    </div>
                `;
            }
        }

        // Load Leaders
        async function loadLeaders() {
            const container = document.getElementById('leadersContent');
            container.innerHTML = '<div class="loading"><div class="spinner"></div> Loading leaders...</div>';

            try {
                const res = await fetch(`${API_BASE}/api/leaders?days_offset=${currentLeadersOffset}`);
                const data = await res.json();

                const categories = Object.values(data.leaders);

                if (categories.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-state-icon">&#127942;</div>
                            <div class="empty-state-title">No Stats Available</div>
                            <p>No completed games for ${data.date}</p>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = categories.map(cat => `
                    <div class="card leader-card">
                        <div class="leader-card-header">
                            <span class="leader-category">${cat.label}</span>
                            <span class="leader-value">${cat.value}</span>
                        </div>
                        <div class="leader-players">
                            ${cat.players.map(p => `
                                <div class="leader-player">
                                    <span class="leader-player-name">${p.name}</span>
                                    <span class="leader-player-team">${p.team}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">&#9888;</div>
                        <div class="empty-state-title">Error Loading Leaders</div>
                        <p>${error.message}</p>
                    </div>
                `;
            }
        }

        // Reusable player search setup
        function initPlayerSearch(inputId, resultsId, onSelect) {
            const input = document.getElementById(inputId);
            const results = document.getElementById(resultsId);
            let timeout;

            input.addEventListener('input', () => {
                clearTimeout(timeout);
                const query = input.value.trim();
                if (query.length < 2) { results.classList.remove('show'); return; }
                timeout = setTimeout(async () => {
                    try {
                        const res = await fetch(`${API_BASE}/api/players/search?q=${encodeURIComponent(query)}`);
                        if (!res.ok) throw new Error('Search failed');
                        const data = await res.json();
                        results.innerHTML = data.players.length === 0
                            ? '<div class="search-result-item">No players found</div>'
                            : data.players.map(p => `
                                <div class="search-result-item" data-id="${p.id}" data-name="${p.name}">
                                    <span>${p.name}</span>
                                    <span style="color: var(--text-secondary); font-size: 0.85rem;">ID: ${p.id}</span>
                                </div>
                            `).join('');
                        results.classList.add('show');
                    } catch (err) {
                        results.innerHTML = '<div class="search-result-item">Error searching</div>';
                        results.classList.add('show');
                    }
                }, 300);
            });

            results.addEventListener('click', (e) => {
                const item = e.target.closest('.search-result-item');
                if (item && item.dataset.id) {
                    onSelect(parseInt(item.dataset.id), item.dataset.name);
                    input.value = '';
                    results.classList.remove('show');
                }
            });

            document.addEventListener('click', (e) => {
                if (!input.contains(e.target) && !results.contains(e.target)) {
                    results.classList.remove('show');
                }
            });
        }

        // Player Tracker search
        initPlayerSearch('playerSearch', 'searchResults', (id, name) => {
            addTrackedPlayer(id, name);
        });

        function addTrackedPlayer(id, name) {
            if (trackedPlayerIds.find(p => p.id === id)) return;

            trackedPlayerIds.push({ id, name });
            updateTrackedPlayersUI();
        }

        function removeTrackedPlayer(id) {
            trackedPlayerIds = trackedPlayerIds.filter(p => p.id !== id);
            updateTrackedPlayersUI();
        }

        function updateTrackedPlayersUI() {
            const container = document.getElementById('trackedPlayers');
            const trackBtn = document.getElementById('trackBtn');

            container.innerHTML = trackedPlayerIds.map(p => `
                <div class="player-chip">
                    <span>${p.name}</span>
                    <button class="player-chip-remove" onclick="removeTrackedPlayer(${p.id})">&times;</button>
                </div>
            `).join('');

            trackBtn.disabled = trackedPlayerIds.length === 0;
        }

        async function loadTrackedStats() {
            if (trackedPlayerIds.length === 0) return;

            const container = document.getElementById('trackerContent');
            container.innerHTML = '<div class="loading"><div class="spinner"></div> Loading player stats...</div>';

            try {
                const ids = trackedPlayerIds.map(p => p.id).join(',');
                const res = await fetch(`${API_BASE}/api/players/stats?ids=${ids}`);
                const data = await res.json();

                if (data.players.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-state-icon">&#128564;</div>
                            <div class="empty-state-title">No Active Games</div>
                            <p>Selected players don't have games in progress today</p>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = `
                    <div class="card" style="overflow-x: auto;">
                        <table class="player-stats-table">
                            <thead>
                                <tr>
                                    <th>Player</th>
                                    <th>Team</th>
                                    <th>MIN</th>
                                    <th>PTS</th>
                                    <th>3PT</th>
                                    <th>REB</th>
                                    <th>AST</th>
                                    <th>BLK</th>
                                    <th>STL</th>
                                    <th>TO</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${data.players.map(p => `
                                    <tr>
                                        <td><strong>${p.name}</strong></td>
                                        <td>${p.team}</td>
                                        <td>${p.minutes}</td>
                                        <td class="${p.points > 0 ? 'highlight' : ''}">${p.points}</td>
                                        <td>${p.threePointers}</td>
                                        <td class="${p.rebounds > 0 ? 'highlight' : ''}">${p.rebounds}</td>
                                        <td class="${p.assists > 0 ? 'highlight' : ''}">${p.assists}</td>
                                        <td>${p.blocks}</td>
                                        <td>${p.steals}</td>
                                        <td>${p.turnovers}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            } catch (error) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">&#9888;</div>
                        <div class="empty-state-title">Error Loading Stats</div>
                        <p>${error.message}</p>
                    </div>
                `;
            }
        }

        // Toggle Game Details (Player Stats)
        async function toggleGameDetails(gameId, cardElement) {
            const detailsDiv = document.getElementById(`details-${gameId}`);

            if (detailsDiv.style.display === 'block') {
                detailsDiv.style.display = 'none';
                return;
            }

            detailsDiv.innerHTML = '<div class="loading" style="padding: 20px;"><div class="spinner"></div> Loading player stats...</div>';
            detailsDiv.style.display = 'block';

            try {
                const res = await fetch(`${API_BASE}/api/games/${gameId}/players`);
                const data = await res.json();

                detailsDiv.innerHTML = data.teams.map(team => {
                    const activePlayers = team.players.filter(p => p.minutes !== '0:00' && p.minutes !== '0' && p.minutes !== 0);
                    return `
                    <div style="padding: 8px; border-top: 1px solid var(--border);">
                        <h4 style="margin-bottom: 6px; color: var(--accent); font-size: 0.75rem;">${team.name} - ${team.score}</h4>
                        <table class="boxscore-table" style="font-size: 0.65rem;">
                            <thead>
                                <tr>
                                    <th style="text-align: left;">Player</th>
                                    <th>MIN</th>
                                    <th>PTS</th>
                                    <th>REB</th>
                                    <th>AST</th>
                                    <th>FG</th>
                                    <th>3PT</th>
                                    <th>FT</th>
                                    <th>STL</th>
                                    <th>BLK</th>
                                    <th>TO</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${activePlayers.map(p => `
                                    <tr>
                                        <td style="text-align: left; white-space: nowrap;">${p.name}</td>
                                        <td>${p.minutes}</td>
                                        <td class="${p.points >= 20 ? 'highlight' : ''}">${p.points}</td>
                                        <td class="${p.rebounds >= 10 ? 'highlight' : ''}">${p.rebounds}</td>
                                        <td class="${p.assists >= 10 ? 'highlight' : ''}">${p.assists}</td>
                                        <td>${p.fg}</td>
                                        <td>${p.threePt}</td>
                                        <td>${p.ft}</td>
                                        <td>${p.steals}</td>
                                        <td>${p.blocks}</td>
                                        <td>${p.turnovers}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>`;
                }).join('');
            } catch (error) {
                detailsDiv.innerHTML = `<div style="padding: 20px; color: var(--text-secondary);">Error loading player stats: ${error.message}</div>`;
            }
        }

        // Load Standings
        async function loadStandings() {
            const container = document.getElementById('standingsContent');
            container.innerHTML = '<div class="loading"><div class="spinner"></div> Loading standings...</div>';

            try {
                const res = await fetch(`${API_BASE}/api/standings`);
                const data = await res.json();

                const renderConference = (teams, name) => `
                    <div class="card" style="overflow-x: auto;">
                        <h3 style="padding: 15px 20px; background: var(--bg-secondary); margin: 0;">${name} Conference</h3>
                        <table class="boxscore-table">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th style="text-align: left;">Team</th>
                                    <th>W</th>
                                    <th>L</th>
                                    <th>PCT</th>
                                    <th>GB</th>
                                    <th>Streak</th>
                                    <th>L10</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${teams.map((team, i) => `
                                    <tr style="${i < 6 ? 'background: rgba(74, 222, 128, 0.05);' : i < 10 ? 'background: rgba(255, 107, 53, 0.05);' : ''}">
                                        <td style="text-align: center; font-weight: 600;">${team.rank}</td>
                                        <td style="text-align: left; font-weight: 500;">${team.name}</td>
                                        <td class="highlight">${team.wins}</td>
                                        <td>${team.losses}</td>
                                        <td>${(team.winPct * 100).toFixed(1)}%</td>
                                        <td>${team.gamesBack}</td>
                                        <td>${team.streak}</td>
                                        <td>${team.last10}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;

                container.innerHTML = renderConference(data.east, 'Eastern') + renderConference(data.west, 'Western');
            } catch (error) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">&#9888;</div>
                        <div class="empty-state-title">Error Loading Standings</div>
                        <p>${error.message}</p>
                    </div>
                `;
            }
        }

        // Load Injuries
        let injuriesData = null;
        let injuriesView = 'list';

        function setInjuriesView(view) {
            injuriesView = view;
            document.getElementById('injuriesListBtn').classList.toggle('active', view === 'list');
            document.getElementById('injuriesGroupBtn').classList.toggle('active', view === 'grouped');
            if (injuriesData) {
                renderInjuries();
            }
        }

        function renderInjuries() {
            const container = document.getElementById('injuriesContent');
            const data = injuriesData;

            if (injuriesView === 'list') {
                // Flat list of all players - compact 2-column newspaper style
                const allPlayers = [];
                data.injuries.forEach(team => {
                    team.players.forEach(p => {
                        allPlayers.push({ ...p, team: team.team });
                    });
                });

                // Split into 4 columns (newspaper style)
                const quarter = Math.ceil(allPlayers.length / 4);
                const cols = [
                    allPlayers.slice(0, quarter),
                    allPlayers.slice(quarter, quarter * 2),
                    allPlayers.slice(quarter * 2, quarter * 3),
                    allPlayers.slice(quarter * 3)
                ];

                const renderPlayer = (p) => {
                    const st = p.status.toLowerCase();
                    // Determine short status first
                    let shortStatus = 'GTD';
                    if (st.includes('out for') || st === 'suspension') {
                        shortStatus = 'OUT';
                    } else if (st.includes('expected') || st.includes('return')) {
                        shortStatus = p.status.match(/Jan \d+|Feb \d+|Mar \d+|Apr \d+|May \d+/i)?.[0] || 'TBD';
                    } else if (st === 'day-to-day' || st === 'game time decision') {
                        shortStatus = 'GTD';  // Unified: both DTD and GTD show as GTD
                    } else if (st === 'out') {
                        shortStatus = 'OUT';
                    }
                    // Colors: OUT=red, dates=yellow, GTD=green
                    const statusColor = (shortStatus === 'OUT') ? '#ef4444' :
                                       (shortStatus !== 'GTD') ? '#f59e0b' : '#4ade80';
                    // Map team names to 3-letter codes
                    const teamCodes = {
                        'hawks': 'ATL', 'celtics': 'BOS', 'nets': 'BKN', 'hornets': 'CHA', 'bulls': 'CHI',
                        'cavaliers': 'CLE', 'mavericks': 'DAL', 'nuggets': 'DEN', 'pistons': 'DET', 'warriors': 'GSW',
                        'rockets': 'HOU', 'pacers': 'IND', 'clippers': 'LAC', 'lakers': 'LAL', 'grizzlies': 'MEM',
                        'heat': 'MIA', 'bucks': 'MIL', 'timberwolves': 'MIN', 'pelicans': 'NOP', 'knicks': 'NYK',
                        'thunder': 'OKC', 'magic': 'ORL', '76ers': 'PHI', 'suns': 'PHX', 'trail blazers': 'POR',
                        'kings': 'SAC', 'spurs': 'SAS', 'raptors': 'TOR', 'jazz': 'UTA', 'wizards': 'WAS',
                        'atlanta': 'ATL', 'boston': 'BOS', 'brooklyn': 'BKN', 'charlotte': 'CHA', 'chicago': 'CHI',
                        'cleveland': 'CLE', 'dallas': 'DAL', 'denver': 'DEN', 'detroit': 'DET', 'golden st.': 'GSW',
                        'houston': 'HOU', 'indiana': 'IND', 'l.a. clippers': 'LAC', 'l.a. lakers': 'LAL', 'memphis': 'MEM',
                        'miami': 'MIA', 'milwaukee': 'MIL', 'minnesota': 'MIN', 'new orleans': 'NOP', 'new york': 'NYK',
                        'oklahoma city': 'OKC', 'orlando': 'ORL', 'philadelphia': 'PHI', 'phoenix': 'PHX', 'portland': 'POR',
                        'sacramento': 'SAC', 'san antonio': 'SAS', 'toronto': 'TOR', 'utah': 'UTA', 'washington': 'WAS'
                    };
                    const teamLower = p.team.toLowerCase();
                    const shortTeam = teamCodes[teamLower] || Object.entries(teamCodes).find(([k]) => teamLower.includes(k))?.[1] || p.team.substring(0, 3).toUpperCase();
                    return `<div style="display: flex; justify-content: space-between; padding: 3px 6px; border-bottom: 1px solid var(--border); font-size: 10px;">
                        <span style="flex: 1; font-weight: 500; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${p.name}</span>
                        <span style="width: 30px; color: var(--text-secondary); text-align: center;">${shortTeam}</span>
                        <span style="width: 45px; text-align: right; color: ${statusColor}; font-weight: 600;">${shortStatus}</span>
                    </div>`;
                };

                const renderColumn = (players) => `
                    <div class="card" style="padding: 0; overflow: hidden;">
                        <div style="padding: 4px 6px; background: var(--bg-secondary); font-size: 9px; color: var(--text-secondary); display: flex; justify-content: space-between;">
                            <span style="flex: 1;">Player</span>
                            <span style="width: 30px; text-align: center;">Team</span>
                            <span style="width: 45px; text-align: right;">Status</span>
                        </div>
                        ${players.map(renderPlayer).join('')}
                    </div>
                `;

                container.innerHTML = `
                    <p style="color: var(--text-secondary); margin-bottom: 10px; font-size: 0.75rem;">
                        ${allPlayers.length} injured | GTD=Game Time Decision | OUT=Season | Date=Return
                    </p>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(min(250px, 100%), 1fr)); gap: 10px;">
                        ${cols.map(renderColumn).join('')}
                    </div>
                `;
            } else {
                // Grouped by team
                container.innerHTML = `
                    <p style="color: var(--text-secondary); margin-bottom: 20px; font-size: 0.9rem;">
                        Last updated: ${data.lastUpdated} | Source: ${data.source}
                    </p>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(min(450px, 100%), 1fr)); gap: 20px;">
                        ${data.injuries.map(team => `
                            <div class="card" style="overflow: hidden;">
                                <div style="padding: 15px 20px; background: var(--bg-secondary); font-weight: 600; border-bottom: 1px solid var(--border);">
                                    ${team.team}
                                    <span style="color: var(--text-secondary); font-weight: normal; font-size: 0.85rem; margin-left: 10px;">${team.players.length} player${team.players.length !== 1 ? 's' : ''}</span>
                                </div>
                                <table class="boxscore-table" style="font-size: 0.85rem;">
                                    <thead>
                                        <tr>
                                            <th style="text-align: left;">Player</th>
                                            <th>Updated</th>
                                            <th>Injury</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${team.players.map(p => `
                                            <tr>
                                                <td style="text-align: left; font-weight: 500;">${p.name}</td>
                                                <td style="color: var(--text-secondary); font-size: 0.8rem;">${p.updated}</td>
                                                <td>${p.injury}</td>
                                                <td style="color: ${(p.status.toLowerCase().includes('out') || p.status.toLowerCase() === 'suspension') ? '#ef4444' : (p.status.toLowerCase().includes('day-to-day') || p.status.toLowerCase().includes('expected')) ? '#f59e0b' : 'var(--success)'}; font-weight: 500;">${p.status}</td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        `).join('')}
                    </div>
                `;
            }
        }

        async function loadInjuries() {
            const container = document.getElementById('injuriesContent');
            container.innerHTML = '<div class="loading"><div class="spinner"></div> Loading injury report...</div>';

            try {
                const res = await fetch(`${API_BASE}/api/injuries`);
                const data = await res.json();

                if (!res.ok) {
                    throw new Error(data.detail || 'Failed to load injuries');
                }

                if (!data.injuries || data.injuries.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-state-icon">&#128170;</div>
                            <div class="empty-state-title">No Injuries Reported</div>
                            <p>All players are healthy!</p>
                        </div>
                    `;
                    return;
                }

                injuriesData = data;
                renderInjuries();
            } catch (error) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">&#9888;</div>
                        <div class="empty-state-title">Error Loading Injuries</div>
                        <p>${error.message}</p>
                    </div>
                `;
            }
        }

        // Last N Games
        let lastNSelectedPlayer = null;
        let lastNGamesCount = 5;

        document.querySelectorAll('#lastngames .date-btn[data-n]').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('#lastngames .date-btn[data-n]').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                lastNGamesCount = parseInt(btn.dataset.n);
            });
        });

        // Last N Games search
        initPlayerSearch('lastNSearch', 'lastNSearchResults', (id, name) => {
            lastNSelectedPlayer = { id, name };
            document.getElementById('lastNPlayerChip').innerHTML = `
                <div class="player-chip">
                    <span>${name}</span>
                    <button class="player-chip-remove" onclick="lastNSelectedPlayer=null; document.getElementById('lastNPlayerChip').innerHTML=''; document.getElementById('lastNBtn').disabled=true;">&times;</button>
                </div>
            `;
            document.getElementById('lastNBtn').disabled = false;
        });

        async function loadLastNGames() {
            if (!lastNSelectedPlayer) return;
            const container = document.getElementById('lastNContent');
            container.innerHTML = '<div class="loading"><div class="spinner"></div> Loading game log...</div>';

            try {
                const res = await fetch(`${API_BASE}/api/players/${lastNSelectedPlayer.id}/last-n-games?n=${lastNGamesCount}`);
                const data = await res.json();

                if (!data.games || data.games.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-state-icon">&#128564;</div>
                            <div class="empty-state-title">No Games Found</div>
                            <p>No recent game data available for ${data.playerName}</p>
                        </div>
                    `;
                    return;
                }

                const avgOf = (key) => {
                    const played = data.games.filter(g => !g.dnp);
                    if (!played.length) return '-';
                    const sum = played.reduce((acc, g) => acc + (g[key] || 0), 0);
                    return (sum / played.length).toFixed(1);
                };

                container.innerHTML = `
                    <div style="margin-bottom: 8px; color: var(--text-secondary); font-size: 0.85rem;">
                        ${data.games.filter(g => !g.dnp).length} games played of ${data.games.length} shown
                    </div>
                    <div class="card" style="overflow-x: auto;">
                        <table class="player-stats-table">
                            <thead>
                                <tr>
                                    <th style="text-align: left;">Matchup</th>
                                    <th>MIN</th>
                                    <th>PTS</th>
                                    <th>FG</th>
                                    <th>3P</th>
                                    <th>FT</th>
                                    <th>REB</th>
                                    <th>AST</th>
                                    <th>BLK</th>
                                    <th>STL</th>
                                    <th>PF</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${data.games.map(g => g.dnp ? `
                                    <tr style="opacity: 0.5;">
                                        <td style="text-align: left;">${g.matchup}</td>
                                        <td colspan="10" style="text-align: center; color: var(--text-secondary); font-style: italic;">DNP</td>
                                    </tr>
                                ` : `
                                    <tr>
                                        <td style="text-align: left; white-space: nowrap;">${g.matchup}</td>
                                        <td>${g.minutes}</td>
                                        <td class="${g.points >= 20 ? 'highlight' : ''}">${g.points}</td>
                                        <td>${g.fg}</td>
                                        <td>${g.threePointers}</td>
                                        <td>${g.ft}</td>
                                        <td class="${g.rebounds >= 10 ? 'highlight' : ''}">${g.rebounds}</td>
                                        <td class="${g.assists >= 10 ? 'highlight' : ''}">${g.assists}</td>
                                        <td>${g.blocks}</td>
                                        <td>${g.steals}</td>
                                        <td>${g.fouls}</td>
                                    </tr>
                                `).join('')}
                                <tr style="border-top: 2px solid var(--accent); background: var(--bg-secondary); font-weight: 600;">
                                    <td style="text-align: left; color: var(--text-secondary);">AVG</td>
                                    <td>-</td>
                                    <td class="highlight">${avgOf('points')}</td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td>${avgOf('rebounds')}</td>
                                    <td>${avgOf('assists')}</td>
                                    <td>${avgOf('blocks')}</td>
                                    <td>${avgOf('steals')}</td>
                                    <td>-</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                `;
            } catch (error) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">&#9888;</div>
                        <div class="empty-state-title">Error Loading Stats</div>
                        <p>${error.message}</p>
                    </div>
                `;
            }
        }

        // Register Service Worker for PWA
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/static/sw.js');
        }

        // Initial load
        loadScoreboard();
    </script>
    <script defer src="/t/a.js" data-website-id="b68bfbcf-f86b-4e65-9257-bda61e465ddb"></script>
</body>
</html>
